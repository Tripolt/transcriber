# Basis-Image für Node.js
FROM node:18

# Verzeichnis im Container erstellen
WORKDIR /app

# Paketlisten kopieren und Abhängigkeiten installieren
COPY package*.json ./
RUN npm install

# Install required system packages
RUN apt-get update && apt-get install -y \
    python3 python3-pip python3-dev build-essential ffmpeg

# Upgrade pip to the latest version
RUN pip3 install --upgrade pip

# Install openai-whisper with no cache to avoid issues
RUN pip3 install --no-cache-dir openai-whisper

# App-Code kopieren
COPY . .

# Port freigeben
EXPOSE 5000

# Server starten
CMD ["node", "server.js"]